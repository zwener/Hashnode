---
title: "Fun with Microsoft MCP Server for Enterprise"
slug: fun-with-microsoft-mcp-server-for-enterprise
cover: https://cdn.hashnode.com/res/hashnode/image/upload/v1767918205054/a8d90c1b-9cfc-4a01-8c01-820a15772635.png

---

You want to know what I did between Christmas and New Years Eve? Of course I spent time with the family, but that would be no content for a tech blog right?  
I tried out the [**Microsoft MCP Server for Enterprise (preview)**](https://learn.microsoft.com/en-us/graph/mcp-server/overview)

## What is this for?

In general the **Model Context Protocol (MCP)** is a standard that lets AI models securely and consistently access external tools, data, and services.

In our case the MCP is adressing GraphAPI. Its abilities is defined by its [MCP Server scopes](https://learn.microsoft.com/en-us/graph/mcp-server/get-started?tabs=portal%2Cvscode#list-of-mcp-server-scopes). Of course you know some of them, like User.Read.All or Organization.Read.All.  
First key takeaway: the MCP has only read scopes.

The process how the MCP works looks like this:

[![](https://cdn.hashnode.com/res/hashnode/image/upload/v1767917375121/9f267ed0-42d3-4e79-acb2-e4b025b23699.png align="center")](https://learn.microsoft.com/en-us/graph/mcp-server/overview#how-it-works)

You will recognize the single steps at the end of the post in my short ref case.

## What do you have to do?

Honestly - just follow the [Microsoft article](https://learn.microsoft.com/en-us/graph/mcp-server/get-started?tabs=http%2Cvscode) because its on point. Let me outline the basic steps for you:

1. Install **Microsoft.Entra.Beta** PowerShell module (version 1.0.13 or later):
    
    ```powershell
    Install-Module Microsoft.Entra.Beta -Force -AllowClobber
    ```
    
2. To register the MCP Server, you have to connect to Entra and consent to the required permissions:
    
    ```powershell
    Connect-Entra -Scopes 'Application.ReadWrite.All', 'Directory.Read.All', 'DelegatedPermissionGrant.ReadWrite.All'
    ```
    
3. Register the Microsoft MCP Server for Enterprise in your tenant and grant all permissions to Visual Studio Code:
    
    ```powershell
    Grant-EntraBetaMCPServerPermission -ApplicationName VisualStudioCode
    ```
    
4. After the grant you will find some new Enterprise Applications:  
    
    | Name | Globally unique **appId** (client ID) |
    | --- | --- |
    | Microsoft MCP Server for Enterprise | `e8c77dc2-69b3-43f4-bc51-3213c9d915b4` |
    | Visual Studio Code | `aebc6443-996d-45c2-90f0-388ff96faa56` |
    
    The â€œserverâ€œ app ships a service principal with the endpoint `https://mcp.svc.cloud.microsoft/enterprise`
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1767908833910/fba51734-f0ba-48d9-9539-2414935afe3a.png align="center")
    
    The â€œclientâ€œ app named â€œVisual Studio Codeâ€œ has the defined MCP scopes:
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1767907327019/3169d855-e955-4f87-b4bb-6a50ba521430.png align="center")
    
5. Connect to MCP using VS Code
    
    Go for it and click [Install Microsoft MCP Server for Enterprise](https://vscode.dev/redirect/mcp/install?name=Microsoft%20MCP%20Server%20for%20Enterprise&config=%7b%22name%22:%22Microsoft%20MCP%20Server%20for%20Enterprise%22%2c%22type%22:%22http%22%2c%22url%22:%22https://mcp.svc.cloud.microsoft/enterprise%22%7d) to open VS Code's MCP install page:
    

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1767908165109/f2a58d5f-778a-467d-b34c-a1647dfac1a4.png align="center")

After a successfull authentication you and your MCP are set.

## Prompting

I have started prompting in VS Code by an easy idea: I asked to evaluate the oldest user logins.  
Itâ€™s fun to see how natural language is translated to proper Graph calls and vice versa:

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1767909526967/7d0c10fe-a1a7-4691-a182-0213fff49903.png align="center")

Then I tried to challenge my mail domain setup regarding security. This was quite fun, but I am glad I had to correct the MCP sometimes ðŸ˜œ

Enjoy the show:

%[https://youtu.be/h6RLPDF8Gvc]